#+TITLE: Score vs Days
#+STARTUP: fold
#+PROPERTY: header-args:ipython :results both :exports both :async yes :session src.:kernel dual_data

* Notebook Settings
#+begin_src ipython
  %load_ext autoreload
  %autoreload 2
  %reload_ext autoreload
  
  %run /home/leon/dual_task/src.notebooks/setup.py
  %matplotlib inline
  %config InlineBackend.figure_format = 'png'
#+end_src

#+RESULTS:
:RESULTS:
: The autoreload extension is already loaded. To reload it, use:
:   %reload_ext autoreload
: Python exe
: /home/leon/mambaforge/envs/src.bin/python
: <Figure size 700x432.624 with 0 Axes>
:END:

* Imports

#+begin_src ipython
  import sys
  import pickle as pkl
  sys.path.insert(0, '../')
  from src.decode.mne_scores import run_mne_scores
  from src.decode.mne_cross_temp import run_mne_cross_temp, plot_scores_mat
  from src.common.fig_grid import create_grid
  from src.common.plot_utils import add_vlines
  from src.common.options import set_options
  from scipy import stats
#+end_src

#+RESULTS:

* Temporal decoding
** Parameters
#+begin_src ipython
  mice = ['ChRM04','JawsM15', 'JawsM18', 'ACCM03', 'ACCM04']
  tasks = ['DPA', 'DualGo', 'DualNoGo']
  days = ['first', 'last']

  kwargs = dict()
  kwargs = {'prescreen': 'fpr', 'pval': 0.05, 'trials': 'correct', 'balance': 'under',
            'method': None, 'bolasso_pval':0.05, 'bolasso_penalty': 'l2',
            'bootstrap': False, 'n_boots': 1000,
            'preprocess': True, 'scaler_BL': 'robust', 'avg_noise':True, 'unit_var_BL':False,
            'clf':'log_loss', 'scaler': None, 'tol':0.001, 'penalty':'l2',
            'out_fold': 'loo', 'n_out': 5,
            'in_fold': 'stratified', 'n_in': 5,
            'random_state': None, 'n_repeats': 100,
            'n_lambda': 20,
            }
#+end_src

#+RESULTS:

** Temporal decoding
*** Single Mouse
#+begin_src ipython
  kwargs['AVG_EPOCHS'] = 0
  mouse = 'ACCM03'
  # for mouse in mice:
  for task in ['DPA', 'DualGo', 'DualNoGo']:
     for day in ['first', 'last']:
        print(task, day)
        run_mne_scores(mouse=mouse, task=task, day=day, **kwargs);        
#+end_src

#+RESULTS:
:RESULTS:
#+begin_example
  DPA first
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS first LASER 0
  ##########################################
  multiple days 0 3 0
  X_S1 (51, 361, 84) X_S2 (54, 361, 84)
  X (105, 361, 84) y (105,)
  cv LeaveOneOut()
  --- 0:00:54.894876 ---
  ACCM03_sample_score_DPA
  DPA last
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS last LASER 0
  ##########################################
  multiple days 0 3 0
  X_S1 (73, 361, 84) X_S2 (77, 361, 84)
  X (150, 361, 84) y (150,)
  cv LeaveOneOut()
  --- 0:01:37.363986 ---
  ACCM03_sample_score_DPA
  DualGo first
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS first LASER 0
  ##########################################
  multiple days 0 3 0
  X_S1 (44, 361, 84) X_S2 (38, 361, 84)
  X (82, 361, 84) y (82,)
  cv LeaveOneOut()
  --- 0:00:38.634789 ---
  ACCM03_sample_score_DualGo
  DualGo last
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS last LASER 0
  ##########################################
  multiple days 0 3 0
  X_S1 (70, 361, 84) X_S2 (64, 361, 84)
  X (134, 361, 84) y (134,)
  cv LeaveOneOut()
  --- 0:01:32.121969 ---
  ACCM03_sample_score_DualGo
  DualNoGo first
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS first LASER 0
  ##########################################
  multiple days 0 3 0
  X_S1 (53, 361, 84) X_S2 (51, 361, 84)
  X (104, 361, 84) y (104,)
  cv LeaveOneOut()
  --- 0:00:53.432424 ---
  ACCM03_sample_score_DualNoGo
  DualNoGo last
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS last LASER 0
  ##########################################
  multiple days 0 3 0
  X_S1 (73, 361, 84) X_S2 (73, 361, 84)
  X (146, 361, 84) y (146,)
  cv LeaveOneOut()
  --- 0:01:35.005797 ---
  ACCM03_sample_score_DualNoGo
#+end_example
[[file:./.ob-jupyter/adc05059af9cc84a78d3115ced6fafd0cec41cde.png]]
[[file:./.ob-jupyter/ad3d763d128adb3cda14e1fba5a2da6c0f50cfcc.png]]
[[file:./.ob-jupyter/00a24ef57a5c14341c529f652f90423d532810f1.png]]
:END:

*** All Mice
#+begin_src ipython
  kwargs['AVG_EPOCHS'] = 0
  score_mouse = []
  for mouse in mice:
    score_task = []
    for task in ['DPA', 'DualGo', 'DualNoGo']:
      score_day = []
      for day in ['first', 'last']:
        print(mouse, task, day)
        scores = run_mne_scores(mouse=mouse, task=task, day=day, **kwargs)
        plt.close('all')
        score_day.append(scores)
      score_task.append(score_day)
    score_mouse.append(score_task)

  score_mouse = np.array(score_mouse)
#+end_src

#+RESULTS:

#+begin_src ipython
  filename = "../data/score_day_all_mice_" + kwargs['out_fold'] + '_' + kwargs['penalty'] + ".pkl"
  pkl.dump(score_mouse, open(filename + ".pkl", "wb"))
#+end_src

#+RESULTS:

#+begin_src ipython
  filename = "../data/score_day_all_mice_" + kwargs['out_fold'] + '_' + kwargs['penalty'] + ".pkl"
  score_mouse = pkl.load(open(filename + ".pkl", "rb"))
  print(score_mouse.shape)
#+end_src

#+RESULTS:
: (5, 3, 2, 84)

#+begin_src ipython
  mean_score = np.mean(score_mouse, 0)
  sem_scores = stats.sem(score_mouse, axis=0)
  # Calculate the 95% CI for each time point
  ci_bound = sem_scores * stats.t.ppf((1 + 0.95) / 2., score_mouse.shape[0] - 1)
  print(mean_score.shape, ci_bound.shape)
#+end_src

#+RESULTS:
: (3, 2, 84) (3, 2, 84)

#+begin_src ipython 
  opts = set_options(**kwargs)
#+end_src

#+RESULTS:

#+begin_src ipython
  fig, ax = plt.subplots(2, 1, figsize=[width, 2*height])

  time = np.linspace(0, 14, 84)
  for i in range(3):      

      for day in range(2):
          if i==0:
              ax[day].plot([0, 12], [0.5, 0.5], '--k')
              ax[day].set_title(days[day])
              add_vlines(ax=ax[day])
              ax[day].set_ylabel('Score')
              ax[day].set_xlabel('Time (s)')

          opts['day'] == days[day]
          opts = set_options(**opts)
          if day==1:
              ax[day].plot(time, mean_score[i][day], label=tasks[i], color=opts['pal'][i])
          else:
              ax[day].plot(time, mean_score[i][day], '-', label=tasks[i], color=opts['pal'][i])

          ax[day].fill_between(time,
                             mean_score[i][day] - ci_bound[i][day],
                             mean_score[i][day] + ci_bound[i][day],
                             alpha=0.1,
                             )

      if i==2:
          legend = ax[day].legend(loc='upper right', fontsize=14, frameon=0)
          bbox = legend.get_window_extent().transformed(ax[day].transAxes.inverted())

          # Define the y-coordinate for the text based on the legend's bounding box
          text_y_coord = bbox.y1 + 0.05  # Add a small offset above the legend

          # Add text above the legend
          ax[day].text(1.0, text_y_coord, 'n=5',
                  verticalalignment='bottom',
                  horizontalalignment='right',
                  transform=ax[day].transAxes)
      ax[day]
      plt.savefig('./scores_day_all_mice.svg', dpi=300)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/cbd261828d30b21fa0f81a85610c5486bef1734b.png]]

#+begin_src ipython
  fig, ax = plt.subplots(1, 3, figsize=[3*width, height])

  time = np.linspace(0, 14, 84)
  for i in range(3):      
      ax[i].plot([0, 12], [0.5, 0.5], '--k')
      ax[i].set_title(tasks[i])
      add_vlines(ax=ax[i])
      ax[i].set_ylabel('Score')
      ax[i].set_xlabel('Time (s)')

      for day in range(2):
          opts['day'] == days[day]
          opts = set_options(**opts)
          if day==1:
              ax[i].plot(time, mean_score[i][day], label=days[day], color=opts['pal'][i])
          else:
              ax[i].plot(time, mean_score[i][day], '--', label=days[day], color=opts['pal'][i])

          ax[i].fill_between(time,
                             mean_score[i][day] - ci_bound[i][day],
                             mean_score[i][day] + ci_bound[i][day],
                             alpha=0.2,
                             )

      if i==2:
          legend = ax[i].legend(loc='upper right', fontsize=14)
          bbox = legend.get_window_extent().transformed(ax[i].transAxes.inverted())

          # Define the y-coordinate for the text based on the legend's bounding box
          text_y_coord = bbox.y1 + 0.05  # Add a small offset above the legend

          # Add text above the legend
          ax[i].text(1.0, text_y_coord, 'n=5',
                  verticalalignment='bottom',
                  horizontalalignment='right',
                  transform=ax[i].transAxes)
          
      plt.savefig('./scores_all_mice.svg', dpi=300)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/e1f5eae5f154d786f55f738446b400e6a470175b.png]]
* Days
*** Parameters
#+begin_src ipython
  mice = ['ChRM04','JawsM15', 'JawsM18', 'ACCM03', 'ACCM04']
  tasks = ['DPA', 'DualGo', 'DualNoGo']
  days = ['first', 'last']

  kwargs = dict()
  kwargs = {'prescreen': None, 'pval': 0.05, 'trials': '', 'balance': None,
            'method': None, 'bolasso_pval':0.05, 'bolasso_penalty': 'l2',
            'bootstrap': False, 'n_boots': 1000,
            'preprocess': True, 'scaler_BL': 'robust', 'avg_noise':True, 'unit_var_BL':False,
            'clf':'log_loss', 'scaler': None, 'tol':0.001, 'penalty':'l2',
            'out_fold': 'loo', 'n_out': 5,
            'in_fold': 'stratified', 'n_in': 5,
            'random_state': None, 'n_repeats': 10,
            'n_lambda': 20,
            }
#+end_src

#+RESULTS:

*** Single Mouse
#+begin_src ipython
  mouse = 'JawsM15'
  features = 'sample'
  kwargs['epochs'] = ['ED', 'LD']
  kwargs['T_WINDOW'] = 0.0
#+end_src

#+RESULTS:

#+begin_src ipython
  def get_score_day(**kwargs):
     score_day = []
     for day in range(1, 7):
        kwargs['day'] = day
        score_mat = run_mne_cross_temp(**kwargs)
        score_day.append(score_mat)
     score_day = np.array(score_day)
     return score_day
#+end_src

#+RESULTS:

#+begin_src ipython
  scores = []
  for task in tasks:
      score_task = []
      score_day = get_score_day(mouse=mouse, features=features, task=task, **kwargs)
      # for day in range(1, 7):
      #     kwargs['day'] = day
      #     score_mat = run_mne_cross_temp(mouse=mouse, features=features, task=task, **kwargs)
      #     score_task.append(score_mat)
      scores.append(score_day)
  scores = np.array(scores)
#+end_src

#+RESULTS:
#+begin_example
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (9, 693, 84) X_S2 (10, 693, 84)
  X (19, 693, 2) y (19,)
  --- 0:00:03.086430 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (13, 693, 84) X_S2 (11, 693, 84)
  X (24, 693, 2) y (24,)
  --- 0:00:01.364621 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (13, 693, 84) X_S2 (14, 693, 84)
  X (27, 693, 2) y (27,)
  --- 0:00:01.364263 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 2) y (32,)
  --- 0:00:01.363347 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (13, 693, 84) X_S2 (12, 693, 84)
  X (25, 693, 2) y (25,)
  --- 0:00:01.373465 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS correct DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 2) y (32,)
  --- 0:00:01.363548 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (10, 693, 84) X_S2 (10, 693, 84)
  X (20, 693, 2) y (20,)
  --- 0:00:01.333086 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (7, 693, 84) X_S2 (8, 693, 84)
  X (15, 693, 2) y (15,)
  --- 0:00:01.352946 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (10, 693, 84) X_S2 (10, 693, 84)
  X (20, 693, 2) y (20,)
  --- 0:00:01.333014 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (13, 693, 84) X_S2 (14, 693, 84)
  X (27, 693, 2) y (27,)
  --- 0:00:01.363246 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (13, 693, 84) X_S2 (11, 693, 84)
  X (24, 693, 2) y (24,)
  --- 0:00:01.342196 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS correct DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (12, 693, 84) X_S2 (15, 693, 84)
  X (27, 693, 2) y (27,)
  --- 0:00:01.353615 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (11, 693, 84) X_S2 (9, 693, 84)
  X (20, 693, 2) y (20,)
  --- 0:00:01.332823 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (10, 693, 84) X_S2 (14, 693, 84)
  X (24, 693, 2) y (24,)
  --- 0:00:01.353852 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (12, 693, 84) X_S2 (14, 693, 84)
  X (26, 693, 2) y (26,)
  --- 0:00:01.354117 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (14, 693, 84)
  X (30, 693, 2) y (30,)
  --- 0:00:01.423678 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (10, 693, 84) X_S2 (11, 693, 84)
  X (21, 693, 2) y (21,)
  --- 0:00:01.333548 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE under SCALER None PRESCREEN fpr PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS correct DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (15, 693, 84) X_S2 (16, 693, 84)
  X (31, 693, 2) y (31,)
  --- 0:00:01.382825 ---
#+end_example
#+RESULTS:

#+begin_src ipython
  print(scores[0, 1])
  print(scores[0, 1, 1, 0])
  # print(np.diag(scores[0,1]))
  plot_scores_mat(scores[0,1], 'mat', 'test')
#+end_src

#+RESULTS:
:RESULTS:
: [[0.86285714 0.74285714]
:  [0.74285714 0.77904762]]
: 0.7428571428571428
[[file:./.ob-jupyter/84f4ec0d9e625d5ddf5c6a05cd4cc5fc1a8125ef.png]]
:END:

#+begin_src ipython
  days = np.arange(1, 7)
  plt.plot(days, scores[0, :, 0, 1].T, '-ro')
  plt.plot(days, scores[1, :, 0, 1].T, '-bo')
  plt.plot(days, scores[2, :, 0, 1].T, '-go')
  plt.plot([1, 6], [0.5, 0.5], '--k')
  plt.ylabel('Off Score')
  plt.xlabel('Day')
  plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/cf2cfd7e02240c4555938d02da1344a9d6b119c7.png]]

*** All mice

#+begin_src ipython
  mice = ['ChRM04','JawsM15', 'JawsM18', 'ACCM03', 'ACCM04']
  # mice = ['JawsM18', 'ACCM03', 'ACCM04']
  tasks = ['DPA', 'DualGo', 'DualNoGo']

  features = 'sample'

  score_mouse = []
  for mouse in mice:
      # if ('ACC' in mouse) or ('18' in mouse):
      #     kwargs['penalty'] = 'l2'
      score_task = []
      for task in tasks:
          score = get_score_day(mouse=mouse, features=features, task=task, **kwargs)
          score_task.append(score)
      score_mouse.append(score_task)

  scores = np.array(score_mouse)
  print(scores.shape)
#+end_src

#+RESULTS:
#+begin_example
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.823024 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.737433 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.766282 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.757479 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.877703 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.696172 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.820153 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.714792 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.967899 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.627156 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.715066 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.752304 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.718996 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.898894 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:02.030808 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.624067 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.711811 ---
  loading files from /home/leon/dual_task/src.data/ChRM04
  X_days (1152, 668, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 668, 84) X_S2 (16, 668, 84)
  X (32, 668, 3) y (32,)
  --- 0:00:01.876173 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.876939 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.754399 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.789366 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.868875 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.838744 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.795645 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.735749 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.664797 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.837412 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.706126 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.781770 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.827082 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.859761 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.967603 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.868749 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.822051 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.825665 ---
  loading files from /home/leon/dual_task/src.data/JawsM15
  X_days (1152, 693, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 693, 84) X_S2 (16, 693, 84)
  X (32, 693, 3) y (32,)
  --- 0:00:01.855042 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.559652 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.509238 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.563899 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.390046 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.462058 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.565365 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.503115 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.557711 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.540162 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.518128 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.599290 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.521327 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.496501 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.484902 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.573629 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.617160 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.605356 ---
  loading files from /home/leon/dual_task/src.data/JawsM18
  X_days (1152, 444, 84) y_days (1152, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (16, 444, 84) X_S2 (16, 444, 84)
  X (32, 444, 3) y (32,)
  --- 0:00:01.633904 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (26, 361, 84) X_S2 (26, 361, 84)
  X (52, 361, 3) y (52,)
  --- 0:00:01.637618 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (28, 361, 84) X_S2 (26, 361, 84)
  X (54, 361, 3) y (54,)
  --- 0:00:01.766405 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (26, 361, 84) X_S2 (28, 361, 84)
  X (54, 361, 3) y (54,)
  --- 0:00:01.758108 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (28, 361, 84) X_S2 (27, 361, 84)
  X (55, 361, 3) y (55,)
  --- 0:00:01.858574 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (25, 361, 84) X_S2 (26, 361, 84)
  X (51, 361, 3) y (51,)
  --- 0:00:01.696372 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (27, 361, 84) X_S2 (27, 361, 84)
  X (54, 361, 3) y (54,)
  --- 0:00:01.607340 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (27, 361, 84) X_S2 (27, 361, 84)
  X (54, 361, 3) y (54,)
  --- 0:00:01.612510 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (26, 361, 84) X_S2 (27, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.845359 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (27, 361, 84) X_S2 (26, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.665297 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (27, 361, 84) X_S2 (26, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.829144 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (26, 361, 84) X_S2 (28, 361, 84)
  X (54, 361, 3) y (54,)
  --- 0:00:01.684582 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (27, 361, 84) X_S2 (26, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.671650 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (27, 361, 84) X_S2 (27, 361, 84)
  X (54, 361, 3) y (54,)
  --- 0:00:01.758547 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (28, 361, 84) X_S2 (25, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.707345 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (25, 361, 84) X_S2 (28, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.764438 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (26, 361, 84) X_S2 (26, 361, 84)
  X (52, 361, 3) y (52,)
  --- 0:00:01.706612 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (28, 361, 84) X_S2 (27, 361, 84)
  X (55, 361, 3) y (55,)
  --- 0:00:01.908631 ---
  loading files from /home/leon/dual_task/src.data/ACCM03
  X_days (960, 361, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (26, 361, 84) X_S2 (27, 361, 84)
  X (53, 361, 3) y (53,)
  --- 0:00:01.782851 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (26, 113, 84) X_S2 (26, 113, 84)
  X (52, 113, 3) y (52,)
  --- 0:00:01.291053 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (27, 113, 84)
  X (54, 113, 3) y (54,)
  --- 0:00:01.291294 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (27, 113, 84)
  X (54, 113, 3) y (54,)
  --- 0:00:01.365574 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (26, 113, 84)
  X (53, 113, 3) y (53,)
  --- 0:00:01.183142 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (25, 113, 84) X_S2 (27, 113, 84)
  X (52, 113, 3) y (52,)
  --- 0:00:01.207237 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DPA TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (28, 113, 84) X_S2 (27, 113, 84)
  X (55, 113, 3) y (55,)
  --- 0:00:01.250497 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (26, 113, 84) X_S2 (27, 113, 84)
  X (53, 113, 3) y (53,)
  --- 0:00:01.247019 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (28, 113, 84) X_S2 (26, 113, 84)
  X (54, 113, 3) y (54,)
  --- 0:00:01.257001 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (26, 113, 84) X_S2 (27, 113, 84)
  X (53, 113, 3) y (53,)
  --- 0:00:01.228486 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (26, 113, 84)
  X (53, 113, 3) y (53,)
  --- 0:00:01.228240 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (26, 113, 84) X_S2 (27, 113, 84)
  X (53, 113, 3) y (53,)
  --- 0:00:01.294450 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (27, 113, 84)
  X (54, 113, 3) y (54,)
  --- 0:00:01.193758 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 1 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (28, 113, 84)
  X (55, 113, 3) y (55,)
  --- 0:00:01.242656 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 2 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (25, 113, 84)
  X (52, 113, 3) y (52,)
  --- 0:00:01.309971 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 3 LASER 0
  ##########################################
  single day
  X_S1 (26, 113, 84) X_S2 (27, 113, 84)
  X (53, 113, 3) y (53,)
  --- 0:00:01.309142 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 4 LASER 0
  ##########################################
  single day
  X_S1 (27, 113, 84) X_S2 (27, 113, 84)
  X (54, 113, 3) y (54,)
  --- 0:00:01.226270 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 5 LASER 0
  ##########################################
  single day
  X_S1 (28, 113, 84) X_S2 (27, 113, 84)
  X (55, 113, 3) y (55,)
  --- 0:00:01.213483 ---
  loading files from /home/leon/dual_task/src.data/ACCM04
  X_days (960, 113, 84) y_days (960, 6)
  ##########################################
  PREPROCESSING: SCALER robust AVG MEAN False AVG NOISE True UNIT VAR False
  ##########################################
  ##########################################
  MODEL: log_loss FOLDS stratified RESAMPLE None SCALER None PRESCREEN None PCA False METHOD None
  ##########################################
  DATA: FEATURES sample TASK DualNoGo TRIALS  DAYS 6 LASER 0
  ##########################################
  single day
  X_S1 (25, 113, 84) X_S2 (26, 113, 84)
  X (51, 113, 3) y (51,)
  --- 0:00:01.162250 ---
  (5, 3, 6, 3, 3)
#+end_example

#+begin_src ipython
score_mouse = np.array(score_mouse)
#+end_src

#+RESULTS:

#+begin_src ipython
  mean_score = np.mean(score_mouse, 0)
  print(mean_score.shape)
#+end_src
#+RESULTS:
: (3, 6, 3, 3)

#+begin_src ipython
  from scipy import stats

  def get_mean_ci(X, confidence=0.95):

      mean_ = np.mean(X, 0)
      sem_ = stats.sem(X, axis=0)
      # Number of comparisons
      num_tests = X.shape[1] # This is the number of confidence intervals you are calculating

      # Per-comparison Confidence Level for Bonferroni correction
      bonferroni_confidence_level = 1 - (1 - confidence) / num_tests

      # Calculate the t-statistic for the Bonferroni-adjusted confidence level
      t_stat = stats.t.ppf((1 + bonferroni_confidence_level) / 2., X.shape[0] - 1)
      
      # Calculate the Bonferroni-corrected CI for each time point
      ci_bound = sem_ * t_stat
      print(mean_.shape, ci_bound.shape)

      return mean_, ci_bound
#+end_src

#+RESULTS:

#+begin_src ipython
  mean_score, ci_bound = get_mean_ci(score_mouse)
#+end_src

#+RESULTS:
: (3, 6, 3, 3) (3, 6, 3, 3)

#+begin_src ipython
  inp = 1
  out = 1
  days = np.arange(1, 7)
  for i in range(3):
      plt.plot(days, mean_score[i].T[inp][out], '-o', color = opts['pal'][i], label=tasks[i])
      plt.fill_between(days,
                       mean_score[i].T[inp][out] - ci_bound[i].T[inp][out]/5,
                       mean_score[i].T[inp][out] + ci_bound[i].T[inp][out]/5,
                       alpha=0.2, color=opts['pal'][i])

  plt.xlabel('Day')
  plt.ylim([0.4, .8])
  plt.plot([1, 6], [0.5, 0.5], '--k')
  plt.xticks([1, 2, 3, 4, 5, 6])
  
  if inp==out:
      plt.ylabel('Score')
      plt.savefig('../figs/scores/score_all_mice.svg', dpi=300)
  else:
      plt.ylabel('Stability Score')
      plt.savefig('../figs/scores/stability_score_all_mice.svg', dpi=300)

  plt.show()

#+end_src

#+RESULTS:
[[file:./.ob-jupyter/4ad56b76afa140b27cd4219a0a262fef5c5a85e7.png]]


#+begin_src ipython
  JawsM18 = overlaps[2]
  overlaps = np.delete(overlaps, 2, axis=0)
#+end_src

#+RESULTS:
:RESULTS:
# [goto error]
: [0;31m---------------------------------------------------------------------------[0m
: [0;31mNameError[0m                                 Traceback (most recent call last)
: Cell [0;32mIn[142], line 1[0m
: [0;32m----> 1[0m JawsM18 [38;5;241m=[39m [43moverlaps[49m[[38;5;241m2[39m]
: [1;32m      2[0m overlaps [38;5;241m=[39m np[38;5;241m.[39mdelete(overlaps, [38;5;241m2[39m, axis[38;5;241m=[39m[38;5;241m0[39m)
: 
: [0;31mNameError[0m: name 'overlaps' is not defined
:END:

#+begin_src ipython
  import pickle as pkl
  pkl.dump(overlaps, open("../figs/overlaps/overlaps_day.pkl", "wb"))
#+end_src

#+RESULTS:

#+begin_src ipython
  overlaps[2] *= -1
  mean_overlaps = np.mean(np.mean(overlaps, 0), 0)[:, 0]
  # mean_overlaps = np.mean(overlaps[:, 1], 0)[:, 0]
  print(mean_overlaps.shape)
#+end_src

#+RESULTS:
: (6,)

#+begin_src ipython
  sem_scores = stats.sem(all_scores, axis=0)
  # Calculate the 95% CI for each time point
  ci_bound = sem_scores * stats.t.ppf((1 + 0.95) / 2., all_scores.shape[0] - 1)
  lower_bound = mean_scores - ci_bound
  upper_bound = mean_scores + ci_bound
#+end_src


#+begin_src ipython
  days = np.arange(1, 7)
  plt.plot(days, mean_overlaps, '*-k', ms=5)
  for i in range(overlaps.shape[0]):
      plt.plot(days, np.mean(overlaps[i], 0)[:, 0], '-o', ms=5, alpha=.2)
      # plt.plot(days, overlaps[i, 1][:, 0], 'o', ms=5)

  plt.plot([1, 6], [0, 0], '--k')
  plt.xlabel("Day")
  plt.ylabel("Distrator Overlap")
  plt.xticks([1, 2, 3, 4 , 5, 6])
  plt.savefig('../figs/overlaps/overlaps_day.svg', dpi=300)
  
  plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/355b67b45618d0adb9207865758dee3cc8a8fded.png]]

#+begin_src ipython
  mean_overlaps = np.mean(overlaps[:, 1], 0)[:, 0]

  days = np.arange(1, 7)
  plt.plot(days, mean_overlaps, '*-k', ms=5)
  for i in range(overlaps.shape[0]):
      plt.plot(days, overlaps[i, 1][:, 0], '-o', ms=5, alpha=.2)

  plt.plot([1, 6], [0, 0], '--k')
  plt.xlabel("Day")
  plt.ylabel("Dist. Overlap")
  plt.xticks([1, 2, 3, 4 , 5, 6])
  plt.savefig('../figs/overlaps/overlaps_day_go.svg', dpi=300)

  plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/7bcd7336340bc0d553700665f01d555cabfe4adf.png]]
